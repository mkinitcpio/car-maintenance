<div class="category-details">
  <div class="category-details__title-container">
    <div class="category-details__title">
      {{categoryDetails.data.name}}
    </div>
    <div class="category-details__buttons">
      <app-button button-common (click)="onPrint()">
        <mat-icon svgIcon="export-pdf-rounded"></mat-icon>
      </app-button>
    </div>
  </div>

  <div class="category-details__content">
    <div class="info-section">
      <app-widget [title]="'PAGES.CATEGORY_DETAILS.WIDGETS.INFO' | translate" *ngIf="categoryDetails.type === CategoryTypeEnum.Car">
        <section class="car-info__content">
          <div class="car-info__raw">
            <span class="car-info__raw-label">{{"PAGES.CATEGORY_DETAILS.LABELS.VEHICLE_ID" | translate}}</span>
            <span class="car-info__raw-data">{{categoryDetails.data.vehicleId || '-'}}</span>
          </div>
  
          <div class="car-info__raw">
            <span class="car-info__raw-label">{{"PAGES.CATEGORY_DETAILS.LABELS.MAKE" | translate}}</span>
            <span class="car-info__raw-data">{{categoryDetails.data.make || '-'}}</span>
          </div>
  
          <div class="car-info__raw">
            <span class="car-info__raw-label">{{"PAGES.CATEGORY_DETAILS.LABELS.MODEL" | translate}}</span>
            <span class="car-info__raw-data">{{categoryDetails.data.model || '-'}}</span>
          </div>
  
          <div class="car-info__raw">
            <span class="car-info__raw-label">{{"PAGES.CATEGORY_DETAILS.LABELS.YEAR" | translate}}</span>
            <span class="car-info__raw-data">{{categoryDetails.data.year || '-'}}</span>
          </div>
  
          <div class="car-info__raw">
            <span class="car-info__raw-label">{{"PAGES.CATEGORY_DETAILS.LABELS.ENGINE" | translate}}</span>
            <span class="car-info__raw-data">{{categoryDetails.data.engine || '-'}}</span>
          </div>
        </section>
      </app-widget>
  
      <app-widget [title]="'PAGES.CATEGORY_DETAILS.WIDGETS.NOTE' | translate" *ngIf="categoryDetails.type === CategoryTypeEnum.Car">
        <textarea #notesInput class="category-details__notes" [value]="categoryDetails.maintenance.note" placeholder="Type some notes" (focusout)="onTextAreaFocusOut(notesInput.value)"></textarea>
      </app-widget>
  
      <div class="category-details__column">
      <app-widget [title]="'PAGES.DETAIL.OVERALL_EXPENSE' | translate" [info]="'PAGES.CATEGORY_DETAILS.TOOLTIPS.OVERALL_EXPENSE' | translate">
        <div class="car-info__status">
          <span>{{totalCost | numberSeparator:this.settingsService.settings.region}}</span>
          <app-currency [currency]="settingsService.settings.units?.currency"
                        [locale]="settingsService.settings.region">
          </app-currency>
        </div>
      </app-widget>
  
      <app-widget [title]="'PAGES.CATEGORY_DETAILS.WIDGETS.MILEAGE' | translate" *ngIf="categoryDetails.type === CategoryTypeEnum.Car" [info]="'PAGES.CATEGORY_DETAILS.TOOLTIPS.MILEAGE' | translate">
        <div class="car-info__status">
          <span>{{categoryDetails.data.mileage | numberSeparator:this.settingsService.settings.region}}</span>
          <span class="car-info__metric-system">{{ "METRIC_SYSTEM." + (settingsService.settings.units?.metricSystem || MetricSystemEnum[settingsService.settings.region]) | uppercase | translate}}</span>
        </div>
      </app-widget>
    </div>
    </div>

    <ubuntu-container [title]="table.name" *ngFor="let table of categoryDetails.tables">
      <app-button actions
                  *ngIf="categoryDetails.type == CategoryTypeEnum.Car"
                  [matMenuTriggerFor]="contextMenu"
                  [matMenuTriggerData]="{name: table.name}"
                  button-transparent>
        <mat-icon>travel_explore</mat-icon>
      </app-button>
      <app-records-table class="category-details__table"
                         *ngIf="table.data.length"
                         [data]="table.data"
                         (edit)="onEdit($event)"
                         (delete)="onDelete($event)"
      ></app-records-table>
    </ubuntu-container>
  </div>

  <mat-menu #contextMenu="matMenu">
    <ng-template matMenuContent let-name="name">
      <button class="menu-item"
              *ngFor="let site of sitesForSearch"
              mat-menu-item
              (click)="onSearch(site.url, name)">
        <span>{{site.name}}</span>
      </button>
    </ng-template>
  </mat-menu>
</div>